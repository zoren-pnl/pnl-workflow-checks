# name: Generate Third-Party Notices on Release PR

# # Trigger only on PRs to main
# on:
#   pull_request:
#     branches:
#       - master
#     types: [opened, synchronize, reopened]

# permissions:
#   contents: write   # Required to push commits to PR branch

# jobs:
#   generate-notice:
#     runs-on: ubuntu-latest

#     steps:
#       # Checkout the PR branch (staging branch in this PR)
#       - uses: actions/checkout@v4
#         with:
#           ref: ${{ github.head_ref }}
#           fetch-depth: 0

#       # Setup Node
#       - uses: actions/setup-node@v4
#         with:
#           node-version: 20
#           cache: yarn

#       # Install dependencies
#       - run: yarn install --frozen-lockfile

#       # Generate / overwrite THIRD_PARTY_NOTICES.md
#       - name: Generate Third-Party Notices
#         run: |
#           npx license-checker \
#             --production \
#             --excludePrivatePackages \
#             --onlyAllow "MIT;Apache-2.0;BSD;ISC;LGPL-2.1;LGPL-3.0;Python-2.0;CC-BY-4.0;Proprietary" \
#             --summary \
#             --out THIRD_PARTY_NOTICES.md

#       # Commit changes back to PR branch
#       - name: Commit updated notice
#         run: |
#           git config user.name "github-actions[bot]"
#           git config user.email "github-actions[bot]@users.noreply.github.com"

#           git add THIRD_PARTY_NOTICES.md

#           # Always commit (overwrite) if any changes
#           git diff --cached --quiet || git commit -m "chore: update third-party notices"

#           # Push back to the PR branch
#           git push
